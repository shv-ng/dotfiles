#!/bin/bash

echo "ğŸ“¦ Select the type of change:"
PS3="Choose a type (number): "

types=(
    "feat     â†’ new feature"
    "fix      â†’ bug fix"
    "chore    â†’ tooling/config change"
    "docs     â†’ documentation only"
    "test     â†’ adding or fixing tests"
    "refactor â†’ code change that isn't a fix or feature"
    "style    â†’ formatting, missing semi-colons, etc."
    "perf     â†’ performance improvement"
    "ci       â†’ CI config or pipeline change"
    "exit     â†’ cancel"
)

select opt in "${types[@]}"; do
    case $opt in
        "exit     â†’ cancel")
            echo "âŒ Canceled."
            exit 0
            ;;
        *)
            type=$(echo "$opt" | awk '{print $1}')
            if [[ -n "$type" ]]; then
                break
            fi
            ;;
    esac
    echo "âŒ Invalid selection."
done

echo "ğŸ“ What did you do? (short description)"
read -r message

if [[ -z "$message" ]]; then
    echo "âŒ Commit message cannot be empty"
    exit 1
fi

echo "ğŸ—ƒï¸ Stage changes?"
select stage in "all (git add .)" "interactive (git add -p)" "cancel"; do
    case $stage in
        "all (git add .)")
            git add .
            break
            ;;
        "interactive (git add -p)")
            git add -p
            break
            ;;
        cancel)
            echo "âŒ Canceled."
            exit 0
            ;;
        *)
            echo "âŒ Invalid option"
            ;;
    esac
done

commit_msg="$type: $message"
git commit -m "$commit_msg"

echo "âœ… Committed: $commit_msg"
